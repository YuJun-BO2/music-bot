#!/usr/bin/env python3
"""
YouTube Cookie æå–å’Œæ ¼å¼åŒ–å·¥å…·
ä½¿ç”¨æ–¹æ³•ï¼š
1. åœ¨Chromeé–‹ç™¼è€…å·¥å…·ä¸­å¾©åˆ¶cookiesæ•¸æ“š
2. å°‡æ•¸æ“šè²¼åˆ° raw_cookies.txt
3. é‹è¡Œæ­¤è…³æœ¬ç”Ÿæˆ Netscape æ ¼å¼çš„ cookies
"""

import json
import re
from datetime import datetime

def convert_chrome_cookies_to_netscape(raw_cookies_text):
    """å°‡Chromeé–‹ç™¼è€…å·¥å…·çš„cookiesè½‰æ›ç‚ºNetscapeæ ¼å¼"""
    
    # Netscape cookies æ ¼å¼é ­éƒ¨
    netscape_cookies = [
        "# Netscape HTTP Cookie File",
        "# Generated by YouTube Cookie Extractor",
        "# https://curl.se/rfc/cookie_spec.html",
        ""
    ]
    
    # è§£æcookiesæ–‡æœ¬
    lines = raw_cookies_text.strip().split('\n')
    
    for line in lines:
        line = line.strip()
        if not line or line.startswith('#'):
            continue
            
        # å‡è¨­æ ¼å¼ï¼šname=value; domain=.youtube.com; path=/; expires=...
        try:
            # æå–åŸºæœ¬çš„name=value
            if '=' in line:
                parts = line.split('\t') if '\t' in line else [line]
                name_value = parts[0]
                
                if '=' in name_value:
                    name, value = name_value.split('=', 1)
                    
                    # ç”ŸæˆNetscapeæ ¼å¼
                    # domain, domain_specified, path, secure, expires, name, value
                    domain = ".youtube.com"
                    domain_specified = "TRUE"
                    path = "/"
                    secure = "FALSE"
                    expires = "1735689600"  # 2025å¹´åº•
                    
                    netscape_line = f"{domain}\t{domain_specified}\t{path}\t{secure}\t{expires}\t{name}\t{value}"
                    netscape_cookies.append(netscape_line)
        except Exception as e:
            print(f"è·³éç„¡æ•ˆè¡Œ: {line} - {e}")
            continue
    
    return '\n'.join(netscape_cookies)

def extract_important_youtube_cookies():
    """ç”Ÿæˆé‡è¦çš„YouTube cookiesæ¨¡æ¿"""
    important_cookies = [
        "# Netscape HTTP Cookie File",
        "# YouTube Essential Cookies",
        "",
        "# è«‹æ›¿æ›ä¸‹é¢çš„ YOUR_COOKIE_VALUE ç‚ºå¯¦éš›å€¼",
        ".youtube.com\tTRUE\t/\tTRUE\t1735689600\tVISITOR_INFO1_LIVE\tYOUR_VISITOR_INFO_VALUE",
        ".youtube.com\tTRUE\t/\tTRUE\t1735689600\tYSC\tYOUR_YSC_VALUE",
        ".youtube.com\tTRUE\t/\tFALSE\t1735689600\tPREF\tYOUR_PREF_VALUE",
        ".youtube.com\tTRUE\t/\tTRUE\t1735689600\t__Secure-3PSIDCC\tYOUR_PSIDCC_VALUE",
        ".youtube.com\tTRUE\t/\tTRUE\t1735689600\t__Secure-3PSID\tYOUR_PSID_VALUE",
        ".youtube.com\tTRUE\t/\tTRUE\t1735689600\t__Secure-3PAPISID\tYOUR_PAPISID_VALUE",
    ]
    return '\n'.join(important_cookies)

if __name__ == "__main__":
    print("ğŸª YouTube Cookie æå–å·¥å…·")
    print("=" * 50)
    
    # ç”Ÿæˆæ¨¡æ¿
    template = extract_important_youtube_cookies()
    with open("youtube_cookies_template.txt", "w", encoding="utf-8") as f:
        f.write(template)
    
    print("âœ… å·²ç”Ÿæˆ youtube_cookies_template.txt")
    print("\nğŸ“‹ è«‹æŒ‰ä»¥ä¸‹æ­¥é©Ÿç²å–cookies:")
    print("1. æ‰“é–‹Chromeï¼Œè¨ªå• https://www.youtube.com ä¸¦ç™»å…¥")
    print("2. æŒ‰F12æ‰“é–‹é–‹ç™¼è€…å·¥å…·")
    print("3. é»æ“Š Application > Cookies > https://www.youtube.com")
    print("4. æ‰¾åˆ°ä»¥ä¸‹é‡è¦cookiesçš„å€¼:")
    print("   - VISITOR_INFO1_LIVE")
    print("   - YSC") 
    print("   - __Secure-3PSIDCC")
    print("   - __Secure-3PSID")
    print("   - __Secure-3PAPISID")
    print("5. å°‡é€™äº›å€¼æ›¿æ›åˆ° youtube_cookies_template.txt ä¸­")
    print("6. é‡å‘½åç‚º youtube_cookies.txt")